
<head>
    <link href="https://fonts.googleapis.com/css?family=Nunito:400,400i,600,600i,700,700i&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Hind:300,400,600,700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Gentium+Book+Basic:ital@1&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Literata:ital,wght@0,500;1,500&display=swap" rel="stylesheet">

    <link href="style.css" rel="stylesheet">
</head>

<body>
<div id="postlist">

    <router-link to="/"> Post List </router-link>
    <router-link to="/about"> About </router-link>
    <router-link to="/contact"> Contact </router-link>

    <router-view></router-view>
</div>

<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://unpkg.com/vue-router"></script>

<script src="https://www.gstatic.com/firebasejs/7.14.4/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.13.1/firebase-database.js"></script>

<script type="text/x-template" id="s-block-template">
    <component :is="blocktype" :item="this.item" :editing="this.editing" class="s-block" :class="{editing: this.editing}" @click="onClick" @input="onInput" />
</script>

<script type="text/x-template" id="s-quote-template">
    <blockquote @click="onClick">
        <s-text :item="{type: 'header', content: this.item.content}" :editing="this.editing" @input="onInput" />
        <s-text :item="{type: 'footer', content: this.item.footer}" :editing="this.editing" @input="onInputFooter" />
    </blockquote>
</script>

<script type="text/x-template" id="s-image-template">
    <div class="image" @click="onClick">
        <img :src="this.item.content" />
        <input v-show="this.editing" type="file" accept="image/*" @input="onInput" />
    </div>
</script>

<script src="components.js"></script>

<script src="editor.js"></script>

<script>
// Your web app's Firebase configuration
var firebaseConfig = {
    apiKey: "AIzaSyCD6i_bVMiThtY9IvVIaVtUxQwU9I_ioL4",
    authDomain: "blog-bee9e.firebaseapp.com",
    databaseURL: "https://blog-bee9e.firebaseio.com",
    projectId: "blog-bee9e",
    storageBucket: "blog-bee9e.appspot.com",
    messagingSenderId: "89370705170",
    appId: "1:89370705170:web:1c308df99ea1a2b57e07cb"
};
// Initialize Firebase
firebase.initializeApp(firebaseConfig);

var PostList = {
	template: `<ul>
        <li v-for="(post,index) in posts">
            <router-link :to="postPath(index)"> {{ post.title }} </router-link>
            <router-link to="edit.html">edit</router-link>
        </li>
    </ul>`,
    data: function() {
        return {
            posts: []
        }
    },
    methods: {
            postPath(id) {
                return "post/" + id;
            }
        },
    async created() {
            const vm = this;

            var postRef = firebase.database().ref("posts");
            this.posts = (await postRef.once('value')).val();
        }

};

var About = {
	template: "<div><h1>About</h1><p>This is about page</p></div>"
};

var Contact = {
	template: "<div><h1>Contact</h1><p>This is contact page</p></div>"
};


/*var Post = {
    props: ['post'],
    template: '<div>{{post.title}}</div>'
}*/



var routes = [
    { path: '/', component: PostList },
    { path: '/about', component: About },
    { path: '/contact', component: Contact },
    { path: '/post/:id', component: sArticle },
    { path: '/post/:id/edit', component: Editor }
];

var router = new VueRouter({
    routes: routes,
    //mode: 'history',
    base: '/'
});

var app = new Vue({
    el: "#postlist",
    router: router,
    data: {
        posts: []
    },
    methods: {
        postPath(id) {
            return "post/" + id;
        }
    },
    async created() {
        const vm = this;

        var postRef = firebase.database().ref("posts");
        this.posts = (await postRef.once('value')).val();
    }
});

</script>
</body>
